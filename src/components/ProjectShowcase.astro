---
import { Image } from "astro:assets";
import YouTubeEmbed from "./YouTubeEmbed.astro";
import bedroomGray1 from "./../images/bedroom-gray/1.jpg";
import bedroomGray2 from "./../images/bedroom-gray/2.jpg";
import bedroomGray3 from "./../images/bedroom-gray/3.jpg";
import bedroomGray4 from "./../images/bedroom-gray/4.jpg";
import bedroomGray5 from "./../images/bedroom-gray/5.jpg";
import bedroomGray6 from "./../images/bedroom-gray/6.jpg";

import bedroomPink1 from "./../images/bedroom-pink/1.jpg";
import bedroomPink2 from "./../images/bedroom-pink/2.jpg";
import bedroomPink3 from "./../images/bedroom-pink/3.jpg";
import bedroomPink4 from "./../images/bedroom-pink/4.jpg";

import hall1 from "./../images/house/1.jpg";
import hall2 from "./../images/house/2.jpg";
import hall3 from "./../images/house/3.jpg";
import hall4 from "./../images/house/4.jpg";
import hall5 from "./../images/house/5.jpg";
import hall6 from "./../images/house/6.jpg";
import hall7 from "./../images/house/7.jpg";
import hall8 from "./../images/house/8.jpg";
import hall9 from "./../images/house/9.jpg";
import hall10 from "./../images/house/10.jpg";

import kitchen1 from "./../images/Kitchen/1.jpg";
import kitchen2 from "./../images/Kitchen/2.jpg";
// import kitchen3 from "./../images/Kitchen/3.jpg";
import kitchen4 from "./../images/Kitchen/4.jpg";
import kitchen5 from "./../images/Kitchen/5.jpg";
import kitchen6 from "./../images/Kitchen/6.jpg";
import kitchen7 from "./../images/Kitchen/7.jpg";
import kitchen8 from "./../images/Kitchen/8.jpg";
import kitchen9 from "./../images/Kitchen/9.jpg";
import kitchen10 from "./../images/Kitchen/10.jpg";

import outsideindustry1 from "./../images/outside/industry_1.jpg";
import outsideindustry2 from "./../images/outside/industry_2.jpg";
import outsideindustry3 from "./../images/outside/industry_3.jpg";

import outsideOffice1 from "./../images/outside/office_1.jpg";
import outsideOffice2 from "./../images/outside/office_2.jpg";
import outsideOffice3 from "./../images/outside/office_3.jpg";
import outsideOffice4 from "./../images/outside/office_4.webp";
import outsideOffice5 from "./../images/outside/office_5.jpg";
import outsideOffice6 from "./../images/outside/office_6.jpg";
import outsideOffice7 from "./../images/outside/office_7.png";
import outsideOffice8 from "./../images/outside/office_8.jpg";
import outsideOffice9 from "./../images/outside/office_9.jpg";
import outsideOffice10 from "./../images/outside/office_10.jpg";
import outsideOffice11 from "./../images/outside/office_11.png";
import outsideOffice12 from "./../images/outside/office_12.png";
import outsideOffice13 from "./../images/outside/office_13.jpg";
import outsideOffice14 from "./../images/outside/office_14.jpg";
import outsideOffice15 from "./../images/outside/office_15.jpg";
import outsideOffice16 from "./../images/outside/office_16.webp";
import outsideOffice17 from "./../images/outside/office_17.jpg";
import outsideOffice18 from "./../images/outside/office_18.webp";
import outsideOffice19 from "./../images/outside/office_19.webp";
import outsideOffice20 from "./../images/outside/office_20.webp";
import outsideOffice21 from "./../images/outside/office_21.webp";

import outsideresto1 from "./../images/outside/resto_1.jpg";
import outsideresto2 from "./../images/outside/resto_2.jpg";
import outsideresto3 from "./../images/outside/resto_3.jpg";

import v2_1 from "./../images/v2/1.jpg";
import v2_2 from "./../images/v2/2.jpg";
import v2_3 from "./../images/v2/3.jpg";
import v2_4 from "./../images/v2/4.jpg";
import v2_5 from "./../images/v2/5.jpg";
import v2_6 from "./../images/v2/6.jpg";
import v2_7 from "./../images/v2/7.jpg";
import v2_8 from "./../images/v2/8.jpg";
import v2_9 from "./../images/v2/9.jpg";
import v2_10 from "./../images/v2/10.jpg";
import v2_11 from "./../images/v2/11.jpg";
import v2_12 from "./../images/v2/12.jpg";
import v2_13 from "./../images/v2/13.jpg";
import v2_14 from "./../images/v2/14.jpg";
import v2_15 from "./../images/v2/15.jpg";
import v2_16 from "./../images/v2/16.jpg";
import v2_17 from "./../images/v2/17.jpg";
import v2_18 from "./../images/v2/18.jpg";
import v2_19 from "./../images/v2/19.jpg";
import v2_20 from "./../images/v2/20.jpg";

// Project Showcase Component - J Design Studio Style
const projects = [
  {
    id: 1,
    title: "Blush Pink Bedroom Retreat",
    subtitle: "Soft Elegance & Tranquility",
    description:
      "A cozy and elegant bedroom designed with blush pink tones, perfect for relaxation and rejuvenation.",
    images: [bedroomPink1, bedroomPink2, bedroomPink3, bedroomPink4],
    videos: ["KWH6syI3nhU"], // Example: Replace with your actual YouTube video IDs
    category: "Residential",
    tags: ["indoor", "pink", "elegant", "bedroom", "cozy"],
    stats: [
      { label: "Project Duration", value: "5 Weeks" },
      { label: "Space Size", value: "300 sq ft" },
      { label: "Budget Range", value: "₹3-5 Lakhs" },
    ],
    features: [
      "Pastel color palette",
      "Custom wardrobe",
      "Ambient lighting",
      "Soft furnishings",
    ],
  },
  {
    id: 2,
    title: "Waves of Beauty",
    subtitle: "Organic Patterns, Modern Comfort",
    description:
      "A natural blend of Brown and Gray revealed in patterns of comfort",
    images: [
      bedroomGray1,
      bedroomGray2,
      bedroomGray3,
      bedroomGray4,
      bedroomGray5,
      bedroomGray6,
    ],
    videos: [], // Add your YouTube video IDs here
    category: "Residential",
    tags: ["indoor", "gray", "brown", "elegant", "bedroom"],
    stats: [
      { label: "Project Duration", value: "6 Weeks" },
      { label: "Space Size", value: "350 sq ft" },
      { label: "Budget Range", value: "₹4-6 Lakhs" },
    ],
    features: [
      "Ambient lighting",
      "Fully furnished",
      "Custom headboard design",
      "Smart storage solutions",
    ],
  },
  {
    id: 3,
    title: "Resting Blues",
    subtitle: "Elegant Minimalism in Blue & Brown",
    description:
      "A refined entrance and hall area featuring a blue sofa, brown furniture, ambient lighting, and a service table. The space is adorned with a wall clock and a TV, complemented by AC for comfort. The design emphasizes minimalism with a touch of elegance.",
    images: [
      hall1,
      hall2,
      hall3,
      hall4,
      hall5,
      hall6,
      hall7,
      hall8,
      hall9,
      hall10,
    ],
    videos: [], // Add your YouTube video IDs here
    category: "Residential",
    tags: [
      "indoor",
      "blue",
      "brown",
      "minimalism",
      "elegant",
      "hall",
      "entrance",
      "sofa",
      "tv",
      "ac",
      "ambient lighting",
      "service table",
      "wall clock",
    ],
    stats: [
      { label: "Project Duration", value: "4 Weeks" },
      { label: "Space Size", value: "400 sq ft" },
      { label: "Budget Range", value: "₹3-5 Lakhs" },
    ],
    features: [
      "Blue color sofa",
      "Predominantly brown furniture",
      "Service table",
      "Wall clock",
      "TV unit",
      "Air conditioning",
      "Ambient lighting",
      "Minimalist and elegant design",
    ],
  },
  {
    id: 4,
    title: "Minimalist Kitchen Elegance",
    subtitle: "Sleek Functionality & Modern Comfort",
    description:
      "A minimalist kitchen design with an eye for elegance, fully furnished and equipped with ambient lighting, chimney, fridge, and a traditional matka for water. The space blends modern convenience with subtle, refined aesthetics.",
    images: [
      kitchen4,
      kitchen2,
      // kitchen3,
      kitchen1,
      kitchen5,
      kitchen6,
      kitchen7,
      kitchen8,
      kitchen9,
      kitchen10,
    ],
    videos: [], // Add your YouTube video IDs here
    category: "Residential",
    tags: [
      "indoor",
      "kitchen",
      "minimalism",
      "elegant",
      "fully furnished",
      "ambient lighting",
      "chimney",
      "fridge",
      "matka",
    ],
    stats: [
      { label: "Project Duration", value: "3 Weeks" },
      { label: "Space Size", value: "180 sq ft" },
      { label: "Budget Range", value: "₹2-4 Lakhs" },
    ],
    features: [
      "Minimalist design with elegant finishes",
      "Fully furnished kitchen",
      "Ambient lighting",
      "Modern chimney",
      "Spacious fridge",
      "Traditional matka for water",
    ],
  },{
  //   id: 5,
  //   title: "Industrial Interior Makeover",
  //   subtitle: "Raw Materials, Robust Aesthetics",
  //   description:
  //     "A functional industrial interior leveraging exposed elements, metal textures, and robust lighting, designed for durability and style.",
  //   images: [
  //     outsideindustry1,
  //     outsideindustry2,
  //     outsideindustry3,
  //   ],
  //   category: "Commercial",
  //   tags: ["industrial", "commercial", "exposed", "metal", "lighting"],
  //   stats: [
  //     { label: "Project Duration", value: "5 Weeks" },
  //     { label: "Space Size", value: "1200 sq ft" },
  //     { label: "Budget Range", value: "₹6-10 Lakhs" },
  //   ],
  //   features: [
  //     "Exposed ceiling and ducting",
  //     "Metal and raw wood finishes",
  //     "High-durability flooring",
  //     "Task and ambient industrial lighting",
  //   ],
  // },
  // {
    id: 6,
    title: "Functional Office Ecosystems",
    subtitle: "Efficiency, Collaboration, and Comfort",
    description:
      "A collection of office spaces designed for productivity—zoned layouts, ergonomic workstations, collaborative hubs, and clean visual hierarchy to keep teams focused and connected.",
    images: [
      outsideOffice14,
      outsideOffice15,
      outsideOffice6,
      outsideOffice10,
      outsideOffice3,
      outsideOffice17,
      outsideOffice5,
    ],
    videos: [], // Add your YouTube video IDs here
    category: "Commercial",
    tags: ["office", "functional", "ergonomic", "collaboration", "workstation"],
    stats: [
      { label: "Project Duration", value: "8 Weeks" },
      { label: "Space Size", value: "2500 sq ft" },
      { label: "Budget Range", value: "₹12-18 Lakhs" },
    ],
    features: [
      "Zoned planning for teams and meetings",
      "Ergonomic desks and seating",
      "Acoustic panels for focused work",
      "Writable walls and collaboration areas",
    ],
  },
  {
    id: 7,
    title: "Luxury Cafe & Restaurant Retreats",
    subtitle: "Relaxation Wrapped in Luxury",
    description:
      "A curated set of cafe and restaurant interiors focusing on mood lighting, plush seating, and premium finishes to create luxurious and relaxing dining experiences.",
    images: [
      outsideresto1,
      outsideresto2,
      outsideresto3,
    ],
    videos: [], // Add your YouTube video IDs here
    category: "Restaurant/Cafe",
    tags: ["restaurant", "cafe", "luxury", "relaxation", "hospitality"],
    stats: [
      { label: "Project Duration", value: "7 Weeks" },
      { label: "Space Size", value: "1800 sq ft" },
      { label: "Budget Range", value: "₹10-15 Lakhs" },
    ],
    features: [
      "Mood and accent lighting",
      "Plush and comfortable seating",
      "Premium textures and finishes",
      "Intimate zones for relaxation",
    ],
  },
  {
    id: 8,
    title: "Luxury Residential Collection",
    subtitle: "Premium Living Spaces & Modern Elegance",
    description:
      "A comprehensive collection of luxury residential interiors featuring contemporary design elements, premium materials, and sophisticated color palettes. This project showcases various living spaces including bedrooms, living areas, and functional zones designed for modern lifestyle needs.",
    images: [v2_1, v2_2, v2_3, v2_4, v2_5, v2_6, v2_7, v2_8, v2_9, v2_10, v2_11, v2_12, v2_13, v2_14, v2_15, v2_16, v2_17, v2_18, v2_19, v2_20],
    videos: [], // Add your YouTube video IDs here
    category: "Residential",
    tags: ["luxury", "residential", "modern", "premium", "contemporary", "elegant", "sophisticated", "bedroom", "living", "functional", "design"],
    stats: [
      { label: "Project Duration", value: "12 Weeks" },
      { label: "Space Size", value: "3200 sq ft" },
      { label: "Budget Range", value: "₹18-25 Lakhs" },
    ],
    features: [
      "Contemporary design with premium finishes",
      "Sophisticated color palettes and textures",
      "Custom furniture and lighting solutions",
      "Multi-functional living spaces",
      "High-end materials and craftsmanship",
      "Smart home integration possibilities",
    ],
  }
  

];

const categories = [...new Set(projects.map((p) => p.category))];
const allTags = [...new Set(projects.flatMap((p) => p.tags))];
---

<section class="py-16 mt-8 bg-gradient-to-br from-gray-50 to-white" id="project-showcase">
  <div class="container mx-auto px-4">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
        Our Featured Projects
      </h2>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto">
        Discover how we transform spaces from concept to reality with our innovative design solutions
      </p>
    </div>

    <!-- Filter Controls -->
    <div class="mb-6">
      <div class="flex flex-wrap justify-center gap-2 mb-6">
        <button class="filter-btn category-btn px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 bg-amber-500 text-white"
          data-category="all">
          All Projects
        </button>
        {categories.map((category) => (
          <button class="filter-btn category-btn px-4 py-2 rounded-full text-sm font-medium border border-gray-200"
            data-category={category}>
            {category}
          </button>
        ))}
      </div>

      <div class="flex flex-wrap justify-center gap-2">
        {allTags.map((tag) => (
          <button class="filter-btn tag-btn px-2 py-2 rounded-full text-xs font-medium transition-all duration-200 bg-gray-100 text-gray-600"
            data-tag={tag}>
            #{tag}
          </button>
        ))}
      </div>
    </div>

    <!-- Projects Grid -->
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-0" id="projects-grid">
      {projects.map((project) => (
        <div class="project-card bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 cursor-pointer"
          data-category={project.category} data-tags={project.tags.join(',')} data-project-id={project.id}>
          <div class="relative h-64">
            <Image src={project.images[0]} alt={project.title} class="w-full h-full object-cover" width={400}
              height={256} quality={80} format="webp" loading="lazy" />
            <div class="absolute top-4 left-4">
              <span class="bg-amber-500 text-white text-xs font-medium px-3 py-1 rounded-full">
                {project.category}
              </span>
            </div>
          </div>
          <div class="p-4">
            <h4 class="text-xl font-bold text-gray-900 mb-2">{project.title}</h4>
            <p class="text-gray-600 mb-4">{project.description.substring(0, 100)}...</p>
            <div class="flex flex-wrap gap-2 mb-4">
              {project.tags.map((tag) => (
                <span class="bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full">#{tag}</span>
              ))}
            </div>
            <div class="flex justify-between text-sm text-gray-500">
            </div>
          </div>
        </div>
      ))}
    </div>

    <!-- Pre-rendered Modals -->
    {projects.map((project) => (
      <div id={`modal-${project.id}`} class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center p-2 md:p-6">
        <div class="bg-white rounded-3xl shadow-2xl max-w-3xl md:max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200">
          <div class="p-4 md:p-6 lg:p-6">
            <div class="flex justify-between items-start mb-6 md:mb-8">
              <div>
                <span class="inline-block bg-amber-100 text-amber-800 text-xs md:text-sm font-medium px-3 py-1 rounded-full mb-2">
                  {project.category}
                </span>
                <h3 class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">{project.title}</h3>
                <p class="text-base md:text-lg text-gray-600">{project.description}</p>
              </div>
              <button class="close-modal text-gray-400 hover:text-gray-600 transition-colors" data-id={project.id}>
                ✕
              </button>
            </div>

            <!-- Media Gallery (Images and Videos) -->
            <div class="space-y-6 mb-6">
              <!-- Images Section -->
              {project.images.length > 0 && (
                <div>
                  <h4 class="text-lg font-semibold text-gray-900 mb-3">Project Images</h4>
                  <div class="flex gap-3 md:gap-5 overflow-x-auto pb-2">
              {project.images.map((img) => (
                <div class="relative group min-w-[220px] md:min-w-[300px] h-60 md:h-80 rounded-xl overflow-hidden shadow-lg border border-gray-100">
                  <Image src={img} alt={project.title} class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                    width={400} height={300} quality={80} format="webp" loading="lazy" />
                  <div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"></div>
                </div>
              ))}
                  </div>
                </div>
              )}
              
              <!-- Videos Section -->
              {project.videos && project.videos.length > 0 && (
                <div>
                  <h4 class="text-lg font-semibold text-gray-900 mb-3">Project Videos</h4>
                  <div class="grid gap-4">
                    {project.videos.map((videoId) => (
                      <div class="bg-gray-50 rounded-xl  shadow-lg border border-gray-200">
                        <div class="max-w-2x2 mx-auto">
                          <YouTubeEmbed 
                            videoId={videoId} 
                            title={`${project.title} - Video`}
                            loading="lazy"
                            class="rounded-lg overflow-hidden shadow-md"
                          />
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            <!-- Features -->
            <div class="bg-gray-50 rounded-2xl p-2 md:p-4">
              <h3 class="text-xl font-bold text-gray-900 mb-4">Key Features</h3>
              <div class="grid md:grid-cols-2 gap-3">
                {project.features.map((feature) => (
                  <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center">
                      ✓
                    </div>
                    <span class="text-gray-700 font-medium">{feature}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    ))}
  </div>
</section>

<script define:vars={{ projects }}>
  const categoryBtns = document.querySelectorAll('.category-btn');
  const tagBtns = document.querySelectorAll('.tag-btn');
  const projectCards = document.querySelectorAll('.project-card');

  let currentCategory = 'all';
  let currentTags = [];

  // Filtering
  function filterProjects() {
    projectCards.forEach(card => {
      const category = card.dataset.category;
      const tags = card.dataset.tags.split(',');

      let show = true;
      if (currentCategory !== 'all' && category !== currentCategory) show = false;
      if (currentTags.length > 0 && !currentTags.some(tag => tags.includes(tag))) show = false;

      card.style.display = show ? 'block' : 'none';
    });
  }

  // Category Filter
  categoryBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      currentCategory = btn.dataset.category;
      categoryBtns.forEach(b => b.classList.remove('bg-amber-500','text-white'));
      btn.classList.add('bg-amber-500','text-white');
      filterProjects();
    });
  });

  // Tag Filter
  tagBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const tag = btn.dataset.tag;
      if (currentTags.includes(tag)) {
        currentTags = currentTags.filter(t => t !== tag);
        btn.classList.remove('bg-amber-500','text-white');
        btn.classList.add('bg-gray-100','text-gray-600');
      } else {
        currentTags.push(tag);
        btn.classList.remove('bg-gray-100','text-gray-600');
        btn.classList.add('bg-amber-500','text-white');
      }
      filterProjects();
    });
  });

  // Modal state management
  let currentOpenModal = null;

  function openModal(id) {
    const modal = document.getElementById(`modal-${id}`);
    if (modal) {
      // Close any currently open modal first
      closeCurrentModal();
      
      // Open the new modal
      modal.classList.remove('hidden');
      modal.classList.add('flex');
      document.body.style.overflow = 'hidden';
      currentOpenModal = id;
      
      // Add history state for back button support
      const currentUrl = new URL(window.location);
      currentUrl.searchParams.set('project', id);
      window.history.pushState({ modalId: id }, '', currentUrl);
    }
  }

  function closeCurrentModal() {
    if (currentOpenModal) {
      const modal = document.getElementById(`modal-${currentOpenModal}`);
      if (modal) {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
      }
      document.body.style.overflow = 'auto';
      currentOpenModal = null;
    }
  }

  function closeModalAndUpdateHistory() {
    closeCurrentModal();
    
    // Update URL to remove project parameter
    const currentUrl = new URL(window.location);
    currentUrl.searchParams.delete('project');
    window.history.pushState(null, '', currentUrl);
  }

  // Modals
  projectCards.forEach(card => {
    card.addEventListener('click', () => {
      const id = card.dataset.projectId;
      openModal(id);
    });
  });

  document.querySelectorAll('.close-modal').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      closeModalAndUpdateHistory();
    });
  });

  // Handle browser back/forward buttons
  window.addEventListener('popstate', (e) => {
    if (e.state && e.state.modalId) {
      // User navigated to a modal state
      openModal(e.state.modalId);
    } else {
      // User navigated away from modal or to base page
      closeCurrentModal();
    }
  });

  // Handle initial page load with project parameter
  window.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const projectId = urlParams.get('project');
    if (projectId) {
      openModal(projectId);
    }
  });

  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && currentOpenModal) {
      closeModalAndUpdateHistory();
    }
  });
</script>
